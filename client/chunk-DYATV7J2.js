import{a as ue,b as fe,c as ve,d as _e,e as he,f as Se,g as ge,h as pt,i as lt,j as Ie,k as oe,l as Ce,m as xe}from"./chunk-27CTTOP4.js";import{c as te,d as ct,e as j}from"./chunk-2EVDRSQI.js";import{a as re,b as J,c as ye}from"./chunk-7S5MROX5.js";import"./chunk-3N3KOUG4.js";import{$a as it,Aa as H,Ba as O,Bb as ie,Ca as Q,D as S,Da as x,E as g,Ea as de,Fa as p,G as $e,Ga as b,H as Z,Ha as v,M as Ue,Na as Me,O as qe,P as n,Pa as Ze,Q as d,Qa as et,Ra as V,S as I,Sa as k,Ta as ee,Ua as tt,Va as y,X as _,_ as He,a as R,aa as m,b as A,ba as Qe,db as ot,ea as P,fa as We,g as Ge,ga as ze,ha as Je,hb as rt,i as F,ia as a,ja as s,ka as h,kb as z,la as le,lb as nt,m as Ae,ma as me,na as w,oa as f,pa as l,qa as Ke,ra as Xe,s as Y,sa as $,sb as D,t as pe,ta as Ye,tb as at,w as N,wb as st,xa as c,ya as C,yb as U,z as G,za as T}from"./chunk-4JK7GZYK.js";var ne=class i extends te{constructor(){super()}static \u0275fac=function(e){return new(e||i)};static \u0275prov=N({token:i,factory:i.\u0275fac})};var q=class i{constructor(t){this._http=t}GetResources(t={}){let e=ye.MapQueryListOptions(t);return this._http.post(U.API.resource.query,e).pipe(F(o=>J.NewList(o,t)))}GetEntry(t={}){let e=at(ye.MapEntryListOptions(R({withPayload:!0},t))),o=ye.MapResourceUrlListOptions(U.API.resource.details,t).replace(":options",e);return this._http.get(o).pipe(F(r=>J.NewInstance(r,t)))}CreateResource(t,e=!1){let o=J.PrepCreate(t);return e?this._http.post(U.API.space.create,o).pipe(F(r=>A(R({},t),{id:st()}))):this._http.post(U.API.resource.create,o).pipe(F(r=>R(R({},t),J.NewInstanceFromResponse(r,{space:t.space}))))}SaveResource(t){let e=J.PrepSave(t);return this._http.post(U.API.resource.delete,e).pipe(F(o=>R(R({},t),J.NewInstanceFromResponse(o,{space:t.space}))))}DeleteResource(t){let e=J.PrepDelete(t);return this._http.post(U.API.resource.delete,e).pipe(F(o=>!0))}static \u0275fac=function(e){return new(e||i)(G(it))};static \u0275prov=N({token:i,factory:i.\u0275fac,providedIn:"root"})};var M=class i extends ct{constructor(){super()}static \u0275fac=function(e){return new(e||i)};static \u0275prov=N({token:i,factory:i.\u0275fac})};var B=class i extends te{constructor(e){super("DEBUG");this.resourceService=e;super.SetList([])}GetResources(e,o){let r=o?.id||e,u=this.currentList.find(E=>E.id===r);return u?.populated?this.GetChildren(r):this.resourceService.GetResources({space:e,resourceType:o?.type,subpath:o?.subpath}).pipe(Y(E=>(u&&(u.populated=!0),this.appendList(E.matches.map(X=>A(R({},X),{parentId:r,expanded:!1,populated:!1}))))),Y(E=>this.GetChildren(r)))}GetChildren(e){return Ge(this.currentList.filter(o=>o.parentId===e))}Sync(e){if(e?.path&&e?.source==="route"){let o=e.path.split("/");this.currentList.filter(r=>r.type==="folder").forEach(r=>{o.includes(r.shortname)&&(r.expanded=!0)})}}Toggle(e){e.type==="folder"&&this.editItem(A(R({},e),{expanded:!e.expanded}))}AddFolder(e,o){let r=this.currentList.find(u=>u.path===`${e.space}/folder/${o}`);r&&r.populated&&this.addItem(A(R({},e),{parentId:r.id,expanded:!1,populated:!1}))}DeleteFolder(e){this.removeItem(e)}static \u0275fac=function(o){return new(o||i)(G(q))};static \u0275prov=N({token:i,factory:i.\u0275fac})};function _t(i,t){if(i&1&&(a(0,"div",5)(1,"pre"),c(2),p(3,"json"),s()()),i&2){l(2);let e=x(0);n(2),T("",b(3,1,e),`
`)}}function ht(i,t){if(i&1&&(a(0,"pre"),c(1),p(2,"json"),s()),i&2){l(3);let e=x(0);n(),C(b(2,1,e.body))}}function St(i,t){if(i&1&&c(0),i&2){l(3);let e=x(0);T(" ",e.body," ")}}function gt(i,t){if(i&1&&h(0,"div",6),i&2){l(3);let e=x(0);m("innerHTML",e.body.text,Ue)}}function It(i,t){if(i&1&&c(0),i&2){l(3);let e=x(0);T(" ",e.body," ")}}function Ct(i,t){if(i&1&&(a(0,"div",5),_(1,ht,3,3,"pre")(2,St,1,1)(3,gt,1,1,"div",6)(4,It,1,1),s()),i&2){l(2);let e=x(0);n(),P(e.contentType==="json"?1:-1),n(),P(e.contentType==="text"?2:-1),n(),P(e.contentType==="html"?3:-1),n(),P(e.contentType==="markdown"?4:-1)}}function xt(i,t){if(i&1){let e=w();a(0,"div")(1,"div",1)(2,"button",2),f("click",function(){S(e);let r=l(3);return g(r.ishee=!0)}),c(3,"RAW"),s(),a(4,"button",2),f("click",function(){S(e);let r=l(3);return g(r.ishee=!1)}),c(5,"Content"),s()(),a(6,"h3"),c(7),s(),a(8,"div",3),c(9),s(),_(10,_t,4,3,"div",4)(11,Ct,5,4,"div",4),s()}if(i&2){l();let e=x(0),o=l(2);n(7),C(e.displayname),n(2),C(e.description),n(),m("ngIf",o.ishee),n(),m("ngIf",!o.ishee)}}function yt(i,t){if(i&1&&(O(0),_(1,xt,12,4,"div",0)),i&2){l(2);let e=x(0),o=Q(e[0]);n(),m("ngIf",o)}}function Rt(i,t){if(i&1&&_(0,yt,2,2,"div"),i&2){let e=l();P(e.type==="content"?0:-1)}}var Pe=class i{constructor(t,e,o,r,u,E){this.resourceService=t;this.pathState=e;this.treeState=o;this.resourecState=r;this.toast=u;this.router=E}space;type;set path(t){t!==null&&this.pathState.SetState({path:t,type:this.type,space:this.space,source:"route"})}resources$;ishee=!1;ngOnInit(){this.resources$=this.pathState.stateItem$.pipe(Ae(t=>t?.source==="route"),Y(t=>this.resourceService.GetResources({space:this.space,subpath:t.path,resourceType:this.type,withPayload:!0})),Y(t=>this.resourecState.SetList(t.matches)))}goto(t){this.router.navigateByUrl(`/spaces/${t.path}`)}delete(t){this.resourceService.DeleteResource(t).subscribe({next:()=>{this.treeState.DeleteFolder(t),this.resourecState.removeItem(t),this.toast.ShowSuccess("DONE")}})}static \u0275fac=function(e){return new(e||i)(d(q),d(M),d(B),d(ne),d(oe),d(z))};static \u0275cmp=I({type:i,selectors:[["ng-component"]],inputs:{space:"space",type:"type",path:"path"},features:[de([ne])],decls:3,vars:4,consts:[[4,"ngIf"],[1,"box","spaced","txt-r"],[1,"btn-fake",3,"click"],[1,"spaced"],["class","box box-white",4,"ngIf"],[1,"box","box-white"],[3,"innerHTML"]],template:function(e,o){if(e&1&&(O(0),p(1,"async"),_(2,Rt,1,1)),e&2){let r=Q(b(1,1,o.resources$));n(2),P(r?2:-1)}},dependencies:[y,V,k,tt,D],encapsulation:2,changeDetection:0})};function bt(i,t){if(i&1){let e=w();a(0,"i",10),f("click",function(){S(e);let r=l(2);return g(r.toggle())}),c(1),s()}if(i&2){let e=l(2);n(),C(e.resource.expanded?"openfolder":"folder")}}function Dt(i,t){if(i&1){let e=w();a(0,"i",10),f("click",function(){S(e);let r=l(2);return g(r.toggle())}),c(1,"templates"),s()}}function Pt(i,t){if(i&1){let e=w();a(0,"div",0)(1,"div",1),_(2,bt,2,1,"i",2)(3,Dt,2,0,"i",2),a(4,"a",3),f("click",function(){S(e);let r=l();return g(r.select())}),c(5),s(),a(6,"div",4),c(7),a(8,"div",5),c(9),s()()(),a(10,"div",6),c(11),p(12,"translate"),p(13,"date"),h(14,"br"),a(15,"span",7),c(16),p(17,"translate"),p(18,"date"),s()(),a(19,"div",8)(20,"i",9),f("click",function(){S(e);let r=l();return g(r.delete())}),c(21,"delete"),s()()()}if(i&2){let e=l();n(2),m("ngIf",e.resource.type==="folder"),n(),m("ngIf",e.resource.type!=="folder"),n(2),C(e.resource.displayname),n(2),H(" ",e.resource.shortname," - ",e.resource.contentType,". "),n(2),T(" ",e.resource.description," "),n(2),H(" ",v(12,10,"Last updated","LastUpdated"),": ",b(13,13,e.resource.updated)," "),n(5),H("",v(17,15,"Created","Created")," ",b(18,18,e.resource.created),"")}}var Le=class i{resource;onToggle=new Z;onSelect=new Z;onDelete=new Z;constructor(){}ngOnInit(){}toggle(){this.onToggle.emit(this.resource)}select(){this.onSelect.emit(this.resource)}delete(){this.onDelete.emit(this.resource)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=I({type:i,selectors:[["dm-resource-card"]],inputs:{resource:"resource"},outputs:{onToggle:"onToggle",onSelect:"onSelect",onDelete:"onDelete"},decls:1,vars:1,consts:[[1,"card"],[1,"content"],["class","liga cam rbreath",3,"click",4,"ngIf"],[1,"cam",3,"click"],[1,"small","resource-full"],[1,"light"],[1,"tail","resource-full"],[1,"smaller"],[1,"hbreath","resource-full"],[1,"liga","a",3,"click"],[1,"liga","cam","rbreath",3,"click"]],template:function(e,o){e&1&&_(0,Pt,22,20,"div",0),e&2&&P(o.resource?0:-1)},dependencies:[y,V,ee,D,j],encapsulation:2,changeDetection:0})};function wt(i,t){if(i&1&&(O(0),p(1,"async"),h(2,"dm-resource-nodes",4)),i&2){let e=l().$implicit,o=l(2),r=b(1,2,o.GetChildren(e));n(2),m("space",o.space)("nodes",r)}}function Lt(i,t){if(i&1){let e=w();a(0,"li")(1,"dm-resource-card",3),f("onSelect",function(){let r=S(e).$implicit,u=l(2);return g(u.select(r))})("onToggle",function(){let r=S(e).$implicit,u=l(2);return g(u.toggle(r))}),s(),_(2,wt,3,4,"dm-resource-nodes",4),s()}if(i&2){let e=t.$implicit;n(),m("resource",e),n(),P(e.expanded?2:-1)}}function Tt(i,t){if(i&1&&(a(0,"ul",1),_(1,Lt,3,2,"li",2),s()),i&2){let e=l();n(),m("ngForOf",e.nodes)}}var Te=class i{constructor(t,e,o){this.treeState=t;this.router=e;this.pathState=o}nodes;space;ngOnInit(){}GetChildren(t){return this.treeState.GetResources(this.space,t).pipe(pe(e=>this.treeState.Sync(this.pathState.currentItem)))}select(t){this.router.navigateByUrl(`/spaces/${t.path}`)}toggle(t){t.type==="folder"&&(this.pathState.UpdateState({source:"toggle"}),this.treeState.Toggle(t))}static \u0275fac=function(e){return new(e||i)(d(B),d(z),d(M))};static \u0275cmp=I({type:i,selectors:[["dm-resource-nodes"]],inputs:{nodes:"nodes",space:"space"},decls:1,vars:1,consts:[["class","alist lbreath breath",4,"ngIf"],[1,"alist","lbreath","breath"],[4,"ngFor","ngForOf"],[3,"onSelect","onToggle","resource"],[3,"space","nodes"]],template:function(e,o){e&1&&_(0,Tt,2,1,"ul",0),e&2&&m("ngIf",o.nodes==null?null:o.nodes.length)},dependencies:[i,y,et,V,k,D,Le],encapsulation:2,changeDetection:0})};var Ee=class i{constructor(t,e){this.treeState=t;this.pathState=e}id;space;nodes$;ngOnInit(){this.nodes$=this.treeState.GetResources(this.space,null).pipe(pe(t=>this.treeState.Sync(this.pathState.currentItem)))}static \u0275fac=function(e){return new(e||i)(d(B),d(M))};static \u0275cmp=I({type:i,selectors:[["dm-resource-list"]],inputs:{id:"id",space:"space"},decls:3,vars:4,consts:[[3,"nodes","space"]],template:function(e,o){if(e&1&&(O(0),p(1,"async"),h(2,"dm-resource-nodes",0)),e&2){let r=b(1,2,o.nodes$);n(2),m("nodes",r)("space",o.space)}},dependencies:[y,k,D,Te],encapsulation:2,changeDetection:0})};function Ft(i,t){i&1&&(a(0,"cr-input",1),p(1,"translate"),h(2,"input",7),s(),a(3,"cr-input",1),p(4,"translate"),h(5,"input",8),s()),i&2&&($("placeholder",v(1,4,"Content type","ContentType")),n(2),m("required",!0),n(),$("placeholder",v(4,7,"Body","Body")),n(2),m("required",!1))}var Ne=class i{constructor(t,e){this.fb=t;this.toast=e}data;dialog;forceValidation=!1;resourceForm;ngOnInit(){this.resourceForm=this.fb.group({displayname:[],shortname:[],description:[],type:[this.data?.type||"folder"],contentType:["json"],body:[]})}saveSpace(){if(this.forceValidation=!1,this.toast.Hide(),this.resourceForm.valid){let t=this.resourceForm.value,e=R({},t);this.dialog.close(e)}else this.forceValidation=!0,this.toast.ShowError("INVALID_FORM")}static \u0275fac=function(e){return new(e||i)(d(lt),d(oe))};static \u0275cmp=I({type:i,selectors:[["ng-component"]],decls:17,vars:25,consts:[[3,"ngSubmit","formGroup"],[3,"placeholder"],["type","text","id","displayname","crinput","","formControlName","displayname",1,"w100",3,"required"],["type","text","id","shortname","crinput","","formControlName","shortname",1,"w100",3,"required"],["helptext",""],["type","text","id","description","crinput","","formControlName","description",1,"w100",3,"required"],["type","submit",1,"btn-rev"],["type","text","id","contenttype","crinput","","formControlName","contentType",1,"w100",3,"required"],["type","text","id","body","crinput","","formControlName","body",1,"w100",3,"required"]],template:function(e,o){e&1&&(a(0,"form",0),f("ngSubmit",function(){return o.saveSpace()}),a(1,"cr-input",1),p(2,"translate"),h(3,"input",2),s(),a(4,"cr-input",1),p(5,"translate"),h(6,"input",3),le(7,4),c(8),p(9,"translate"),me(),s(),a(10,"cr-input",1),p(11,"translate"),h(12,"input",5),s(),_(13,Ft,6,10),a(14,"button",6),c(15),p(16,"translate"),s()()),e&2&&(m("formGroup",o.resourceForm),n(),$("placeholder",v(2,10,"Display name (en)","DisplayNameEn")),n(2),m("required",!0),n(),$("placeholder",v(5,13,"Shortname","Shortname")),n(2),m("required",!0),n(2),C(v(9,16,"No spacecs allowed","NoSpacesAllowed")),n(2),$("placeholder",v(11,19,"Description (en)","DescriptionEn")),n(2),m("required",!1),n(),P(o.data.type!=="folder"?13:-1),n(2),C(v(16,22,"Save","Save")))},dependencies:[y,D,Ie,_e,ue,fe,ve,ge,he,Se,Ce,xe,j],encapsulation:2,changeDetection:0})};var Vt=["*"],Oe=class i{onClose=new Z;options;close(t){this.onClose.emit(t)}onClick(t){t.matches(".d-overlay")&&this.close(null)}onEscape(t){t.code==="Escape"&&this.close(null)}onMouseDown(t){t.matches(".d-overlay, .modal-dialog, .modal")&&!this.options.ismodal&&this.close(null)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=I({type:i,selectors:[["cr-dialog"]],hostBindings:function(e,o){e&1&&f("click",function(u){return o.onClick(u.target)})("keydown",function(u){return o.onEscape(u)},!1,qe)("mousedown",function(u){return o.onMouseDown(u.target)})},outputs:{onClose:"onClose"},ngContentSelectors:Vt,decls:8,vars:1,consts:[[1,"modal-overlay","d-overlay"],["role","dialog","aria-labelledby","dialogtitle","tabindex","-1",1,"modal"],[1,"modal-header"],["id","dialogtitle",1,"f6","modal-title"],["type","button",1,"modal-close",3,"click"],[1,"modal-body"]],template:function(e,o){e&1&&(Ke(),a(0,"div",0)(1,"div",1)(2,"div",2)(3,"h6",3),c(4),s(),a(5,"button",4),f("click",function(){return o.close()}),s()(),a(6,"div",5),Xe(7),s()()()),e&2&&(n(4),C(o.options==null?null:o.options.title))},dependencies:[y],encapsulation:2,changeDetection:0})};var K=class i{constructor(t,e){this.appRef=t;this.doc=e}dialogs={};open(t,e){let o=e?.providers?.length?$e.create({providers:e.providers}):void 0,r=Me(t,{environmentInjector:this.appRef.injector,elementInjector:o});this.appRef.attachView(r.hostView);let u=r.hostView.rootNodes,E=Me(Oe,{environmentInjector:this.appRef.injector,projectableNodes:[u]}),X=E.hostView.rootNodes[0];e?.id&&(X.id=e.id,this.dialogs[e.id]=E.instance),e?.css&&X.classList.add(...e.css.split(" ")),this.doc.body.append(X),this.appRef.attachView(E.hostView),E.instance.options=A(R({},e),{ismodal:e?.ismodal||!1,title:e?.title||""}),r.instance.data=e?.data,r.instance.dialog=E.instance,r.instance.dialogElement=X;let ut=E.instance.onClose.subscribe(ft=>{e?.onclose&&e.onclose(ft),this.appRef.detachView(E.hostView),E.destroy(),this.appRef.detachView(r.hostView),r.destroy(),e?.id&&delete this.dialogs[e.id],ut.unsubscribe()});return r.instance}get(t){return this.dialogs[t]||null}static \u0275fac=function(e){return new(e||i)(G(He),G(Ze))};static \u0275prov=N({token:i,factory:i.\u0275fac,providedIn:"root"})};function kt(i,t){if(i&1){let e=w();a(0,"a",2),f("click",function(){S(e);let r=l(2),u=x(0);return g(r.createFolder(u,r.enumResourceType.FOLDER))}),a(1,"i",3),c(2,"plus"),s(),c(3),p(4,"translate"),s()}i&2&&(n(3),T(" ",v(4,1,"Add folder","AddFolder"),""))}function jt(i,t){if(i&1){let e=w();a(0,"div",0),c(1),_(2,kt,5,4,"a",1),c(3," | "),a(4,"a",2),f("click",function(){S(e);let r=l(),u=x(0);return g(r.createFolder(u,r.enumResourceType.CONTENT))}),a(5,"i",3),c(6,"plus"),s(),c(7),p(8,"translate"),s()()}if(i&2){let e=l(),o=x(0);n(),T("",o.path," "),n(),m("ngIf",o.type===e.enumResourceType.FOLDER),n(5),T(" ",v(8,3,"Add content","AddContent"),"")}}var Fe=class i{constructor(t,e,o,r,u){this.pathState=t;this.dialog=e;this.router=o;this.resourceListState=r;this.resourceService=u}space;enumResourceType=re;ngOnInit(){}createFolder(t,e){this.dialog.open(Ne,{title:ie.Get("CreateFolder"),css:"modal-half-screen animate fromend",data:{type:e},onclose:o=>{o&&this.resourceService.CreateResource(A(R({},o),{subpath:t.path,space:this.space})).subscribe({next:r=>{this.resourceListState.AddFolder(r,t.path),this.router.navigateByUrl(`/spaces/${r.path}`)}})}})}static \u0275fac=function(e){return new(e||i)(d(M),d(K),d(z),d(B),d(q))};static \u0275cmp=I({type:i,selectors:[["dm-resource-path"]],inputs:{space:"space"},decls:3,vars:4,consts:[[1,"small","spaced"],[3,"click",4,"ngIf"],[3,"click"],[1,"liga"]],template:function(e,o){if(e&1&&(O(0),p(1,"async"),_(2,jt,9,6,"div",0)),e&2){let r=Q(b(1,1,o.pathState.stateItem$));n(2),P(r?2:-1)}},dependencies:[y,V,k,D,j],encapsulation:2,changeDetection:0})};var se=class i{constructor(t,e){this.fb=t;this.toast=e}data;dialog;spaceForm;ngOnInit(){this.spaceForm=this.fb.group({displayname:[],shortname:[],description:[]}),this.data.space&&this.spaceForm.patchValue(this.data.space)}saveSpace(){if(this.toast.Hide(),this.spaceForm.valid){let t=this.spaceForm.value,e=R({},t);this.dialog.close(e)}else this.toast.ShowError("INVALID_FORM")}static \u0275fac=function(e){return new(e||i)(d(pt),d(oe))};static \u0275cmp=I({type:i,selectors:[["ng-component"]],decls:16,vars:24,consts:[["novalidate","",3,"ngSubmit","formGroup"],[1,"spaced",3,"placeholder"],["type","text","id","displayname","crinput","","formControlName","displayname",1,"w100",3,"required"],["error","Required with no spaces",3,"placeholder"],["type","text","id","shortname","crinput","","formControlName","shortname","crpattern","shortname",1,"w100",3,"required"],["helptext",""],[3,"placeholder"],["type","text","id","description","crinput","","formControlName","description",1,"w100",3,"required"],["type","submit",1,"btn-rev"]],template:function(e,o){e&1&&(a(0,"form",0),f("ngSubmit",function(){return o.saveSpace()}),a(1,"cr-input",1),p(2,"translate"),h(3,"input",2),s(),a(4,"cr-input",3),p(5,"translate"),h(6,"input",4),le(7,5),c(8),p(9,"translate"),me(),s(),a(10,"cr-input",6),p(11,"translate"),h(12,"input",7),s(),a(13,"button",8),c(14),p(15,"translate"),s()()),e&2&&(m("formGroup",o.spaceForm),n(),$("placeholder",v(2,9,"Display name (en)","DisplayNameEn")),n(2),m("required",!0),n(),$("placeholder",v(5,12,"Shortname","Shortname")),n(2),m("required",!0),n(2),C(v(9,15,"No spacecs allowed","NoSpacesAllowed")),n(2),$("placeholder",v(11,18,"Description (en)","DescriptionEn")),n(2),m("required",!1),n(2),C(v(15,21,"Save","Save")))},dependencies:[y,D,Ie,_e,ue,fe,ve,ge,he,Se,Ce,xe,j],encapsulation:2,changeDetection:0})};var Ve=class i{constructor(t){this.resourceService=t}_GetSpace(t){return this.resourceService.GetEntry({space:t,resourceType:"space",subpath:`${U.API.rootPath}/${t}`,withPayload:!0,withAttachments:!0})}GetSpace(t){return this.resourceService.GetEntry({space:t,resourceType:"space",subpath:`${U.API.rootPath}/${t}`,withPayload:!0,withAttachments:!0})}GetSpaces(){return this.resourceService.GetResources({type:"spaces"})}CreateSpace(t){return this.resourceService.CreateResource({type:"space",displayname:t.displayname,shortname:t.shortname,space:t.shortname,subpath:"/",description:t.description},!0)}DeleteSpace(t){return this.resourceService.DeleteResource(t)}UpdateSpace(t){return this.resourceService.SaveResource({type:"space",displayname:t.displayname,shortname:t.shortname,space:t.shortname,subpath:"/",description:t.description,id:t.id})}static \u0275fac=function(e){return new(e||i)(G(q))};static \u0275prov=N({token:i,factory:i.\u0275fac,providedIn:"root"})};var ce=class i extends te{constructor(e){super("DEBUG");this.spaceService=e;this.spaceService.GetSpaces().subscribe({next:o=>{super.SetList(o.matches)}})}GetSpace(e){return this.stateList$.pipe(F(o=>o.find(r=>r.shortname===e)))}Create(e){return this.spaceService.CreateSpace(e).pipe(F(o=>o?(super.addItem(o),!0):!1))}Delete(e){return this.spaceService.DeleteSpace(e).pipe(F(o=>o?(super.removeItem(e),!0):!1))}Update(e){return this.spaceService.UpdateSpace(e).pipe(F(o=>o?(super.editItem(o),!0):!1))}static \u0275fac=function(o){return new(o||i)(G(Ve))};static \u0275prov=N({token:i,factory:i.\u0275fac,providedIn:"root"})};function Bt(i,t){if(i&1){let e=w();a(0,"div",10),c(1),p(2,"translate"),p(3,"date"),h(4,"br"),a(5,"span",11),c(6),p(7,"translate"),p(8,"date"),s(),a(9,"div")(10,"button",12),f("click",function(){S(e);let r=l(2),u=x(0);return g(r.delete(u))}),a(11,"i",13),c(12,"delete"),s()(),a(13,"button",12),f("click",function(){S(e);let r=l(2),u=x(0);return g(r.edit(u))}),a(14,"i",13),c(15,"edit"),s()()()()}if(i&2){l(2);let e=x(0);n(),H(" ",v(2,4,"Last updated","LastUpdated"),": ",b(3,7,e.updated)," "),n(5),H("",v(7,9,"Created","Created")," ",b(8,12,e.created),"")}}function Gt(i,t){if(i&1){let e=w();a(0,"div",0)(1,"button",1),f("click",function(){S(e);let r=l();return g(r.expanded=!0)}),c(2,"Open"),s(),a(3,"button",2),f("click",function(){S(e);let r=l();return g(r.expanded=!1)}),c(4,"Close"),s(),a(5,"div",3)(6,"h1",4),c(7),s(),c(8),a(9,"div",5),c(10),s()(),_(11,Bt,16,14,"div",6),h(12,"dm-resource-list",7),s(),a(13,"div",8)(14,"div",9),h(15,"dm-resource-path",7)(16,"router-outlet"),s()()}if(i&2){let e=l(),o=x(0);Qe("expanded",e.expanded),n(7),C(o.displayname),n(),T(" ",o.shortname," "),n(2),T(" ",o.description," "),n(),m("ngIf",e.expanded),n(),m("space",o.space),n(3),m("space",o.space)}}var ke=class i{constructor(t,e,o){this.router=t;this.dialog=e;this.spaceListState=o}space;space$;expanded=!1;ngOnInit(){this.space$=this.spaceListState.GetSpace(this.space)}delete(t){this.spaceListState.Delete(t).subscribe({next:e=>{e&&this.router.navigateByUrl("/spaces")}})}edit(t){this.dialog.open(se,{title:ie.Get("NewSpace"),data:{mode:{forNew:!1},space:t},onclose:e=>{e&&this.spaceListState.Update(e).subscribe({next:o=>{}})}})}static \u0275fac=function(e){return new(e||i)(d(z),d(K),d(ce))};static \u0275cmp=I({type:i,selectors:[["ng-component"]],inputs:{space:"space"},features:[de([B,M])],decls:3,vars:4,consts:[[1,"resource-list"],[1,"btn-fake","incollapse",3,"click"],[1,"btn-fake","inexpand",3,"click"],[1,"box","spaced"],[1,"f5"],[1,"spaced","light","inexpand"],["class","box  bthin",4,"ngIf"],[3,"space"],[1,"resource-page"],[1,"container"],[1,"box","bthin"],[1,"smaller"],[1,"btn-fake",3,"click"],[1,"liga"]],template:function(e,o){if(e&1&&(O(0),p(1,"async"),_(2,Gt,17,8)),e&2){let r=Q(b(1,1,o.space$));n(2),P(r?2:-1)}},dependencies:[y,V,k,ee,D,rt,Ee,Fe,j],encapsulation:2,changeDetection:0})};function At(i,t){if(i&1&&(a(0,"li")(1,"div",6)(2,"div")(3,"a",7),c(4),s(),a(5,"div",8),c(6),s()(),a(7,"div",9),c(8),p(9,"date"),s()()()),i&2){let e=t.$implicit;n(3),Ye("routerLink","/spaces/",e.shortname,"/folder"),n(),C(e.displayname),n(2),H("",e.shortname," ",e.description,""),n(2),T(" ",v(9,6,e.updated,"shortDate")," ")}}function $t(i,t){if(i&1&&(a(0,"ul",5),ze(1,At,10,9,"li",null,We),s()),i&2){l();let e=x(6);n(),Je(e)}}var je=class i{constructor(t,e){this.spaceListState=t;this.dialog=e}spaces$;ngOnInit(){this.spaces$=this.spaceListState.stateList$}create(){this.dialog.open(se,{title:ie.Get("NewSpace"),data:{mode:{forNew:!0}},onclose:t=>{t&&this.spaceListState.Create(t).subscribe({next:()=>{}})}})}static \u0275fac=function(e){return new(e||i)(d(ce),d(K))};static \u0275cmp=I({type:i,selectors:[["ng-component"]],decls:9,vars:8,consts:[[1,"page"],[1,"container"],[1,"spaced"],[1,"btn-rev",3,"click"],["class","row-spaced uc-6 rowlist",4,"ngIf"],[1,"row-spaced","uc-6","rowlist"],[1,"card"],[1,"weight-bold",3,"routerLink"],[1,"smaller","light"],[1,"tail","smaller"]],template:function(e,o){if(e&1){let r=w();a(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),f("click",function(){return S(r),g(o.create())}),c(4),p(5,"translate"),s()(),O(6),p(7,"async"),_(8,$t,3,0,"ul",4),s()()}if(e&2){n(4),C(v(5,2,"Create new","CreateNew")),n(2);let r=Q(b(7,5,o.spaces$));n(2),m("ngIf",r)}},dependencies:[y,V,k,ee,D,nt,j],encapsulation:2,changeDetection:0})};var ar=[{path:"",component:je},{component:ke,path:":space",children:[{component:Pe,matcher:i=>i.length>0?{consumed:i,posParams:{type:i[0],path:new ot(i.slice(1).join("/"),{})}}:null}]}];export{ar as SpaceRoutes};
